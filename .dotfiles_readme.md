# Using a bare git repo and git commands to sync dotfile configurations
Largely based on [this guide](https://developer.atlassian.com/blog/2016/02/best-way-to-store-dotfiles-git-bare-repo/) with a few modifications.

```bash
git init --bare $HOME/.dotfiles
alias dtf='/usr/bin/git --git-dir=$HOME/.dotfiles/ --work-tree=$HOME'
dtf config --local status.showUntrackedFiles no
echo "alias dtf='/usr/bin/git --git-dir=$HOME/.dotfiles/ --work-tree=$HOME'" >> $HOME/.bashrc
```
To add new files, do
```bash
dtf status
dtf add .bashrc
dtf commit -m "added .bashrc"
dtf push -u origin
```

To initiate this on a new system, do
```bash
git clone --bare <git-repo-url> $HOME/.dotfiles
alias dtf='/usr/bin/git --git-dir=$HOME/.dotfiles/ --work-tree=$HOME'
dtf config --local status.showUntrackedFiles no
dtf checkout #Checkout the actual content from the bare repository to your $HOME
```

If there are already files with the same name in $HOME, this is an **yet unproven** way to automatically backup the old files:

```shell
# add these to your .bashrc
function dtf {
   /usr/bin/git --git-dir=$HOME/.dotfiles/ --work-tree=$HOME $@
}

function dtf-checkout {
  dtf checkout
  if [ $? = 0 ]; then
    echo "checked out dotfiles";
    else
      echo "Backing up existing dotfiles";
      mkdir -p $HOME/.doftiles_backup
      dtf checkout 2>&1 | egrep "s+\." | awk{'print $1'} | xargs -I{} mv {} $HOME/.dotfile_backup/{}
  fi;
  dtf checkout
}
```


